<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>for小朱</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" />

  <script>
    // Tailwind 主题扩展
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            love: {
              pink: '#ff6b8b',
              blue: '#8ab4f8',
              light: '#ffe6ef',
              dark: '#c24166',
              gold: '#ffd166'
            }
          },
          fontFamily: {
            romantic: ['"Segoe UI"', 'Roboto', 'system-ui', 'sans-serif']
          },
          dropShadow: {
            heart: '0 8px 20px rgba(255,107,139,.35)'
          },
          boxShadow: {
            glow: '0 0 0 4px rgba(255,107,139,.2), 0 14px 40px rgba(0,0,0,.15)'
          },
          keyframes: {
            float: {
              '0%,100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' }
            },
            pop: {
              '0%': { transform: 'scale(.95)', opacity: 0 },
              '100%': { transform: 'scale(1)', opacity: 1 }
            },
            confetti: {
              '0%': { transform: 'translateY(-100vh) rotate(0)' },
              '100%': { transform: 'translateY(100vh) rotate(720deg)' }
            }
          },
          animation: {
            float: 'float 3s ease-in-out infinite',
            pop: 'pop .45s ease-out both',
            pulseSlow: 'pulse 3s cubic-bezier(0.4,0,0.6,1) infinite'
          }
        }
      }
    }
  </script>

  <style type="text/tailwindcss">
    @layer utilities {
      .bg-blur { backdrop-filter: blur(10px); }
      .text-shadow { text-shadow: 0 2px 8px rgba(0,0,0,.15) }
      .glass { @apply bg-white/80 dark:bg-white/70 backdrop-blur-xl border border-white/60 shadow-glow; }
      .btn-base { @apply font-bold rounded-full shadow-lg hover:shadow-xl transition-transform duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2; }
      .btn-love { @apply btn-base bg-love-pink hover:bg-love-dark text-white focus:ring-love-pink/50; }
      .btn-ghost { @apply btn-base bg-white/70 hover:bg-white text-gray-700 focus:ring-love-blue/40; }
      .safe-px { padding-left: max(1rem, env(safe-area-inset-left)); padding-right: max(1rem, env(safe-area-inset-right)); }
      .safe-py { padding-top: max(1rem, env(safe-area-inset-top)); padding-bottom: max(1rem, env(safe-area-inset-bottom)); }
    }

    /* 轮播背景（使用你的图片路径） */
    .bg-slider {
      animation: slide 22s infinite alternate;
      background-size: cover;
      background-position: center;
    }
    @keyframes slide {
      0%   { background-image: url('0f0b8dcbea5a7156fd9fae174f7c2dac.jpg'); }
      25%  { background-image: url('67c4ebac08969fac8c12da38beed0bd8.jpg'); }
      50%  { background-image: url('691ea470662c7968a90f473681b91d92.jpg'); }
      75%  { background-image: url('c56170642eb563979d2c85f9c04304a3.jpg'); }
      100% { background-image: url('e58c8d90d0e101b25aebd99c53b442f9.jpg'); }
    }

    /* 减少动画：尊重用户偏好 */
    @media (prefers-reduced-motion: reduce) {
      .bg-slider { animation: none; }
      .animate-float, .animate-pulse, .animate-pop { animation: none !important; }
    }
  </style>
</head>

<body class="font-romantic min-h-screen overflow-hidden bg-love-light/40">
  <!-- 背景层 -->
  <div class="fixed inset-0 bg-slider opacity-80 -z-10"></div>
  <div class="fixed inset-0 bg-gradient-to-br from-love-pink/30 via-transparent to-love-blue/30 -z-10"></div>

  <!-- 装饰元素（移动端压低密度） -->
  <div class="pointer-events-none select-none fixed inset-0 md:block hidden">
    <i class="fa fa-heart text-love-pink text-2xl animate-float absolute top-10 left-10 opacity-70 drop-shadow-heart"></i>
    <i class="fa fa-star text-love-blue text-2xl animate-float absolute bottom-10 right-10 opacity-70" style="animation-delay:1s"></i>
    <i class="fa fa-heart-o text-love-pink text-xl animate-float absolute top-1/3 right-1/4 opacity-60" style="animation-delay:2s"></i>
  </div>

  <!-- 主容器：安全区 + 移动优先宽度 -->
  <main class="relative z-10 min-h-screen flex items-center justify-center safe-px safe-py p-3">
    <section class="glass rounded-3xl w-[min(92vw,26rem)] md:w-full md:max-w-xl p-5 md:p-8 animate-pop">
      <header class="text-center mb-6 md:mb-8">
        <h1 class="text-[clamp(1.6rem,6vw,2.6rem)] font-extrabold text-love-dark text-shadow mb-1 md:mb-2 leading-tight">
          <i class="fa fa-heart text-love-pink drop-shadow-heart"></i>
          心动问答
        </h1>
        <p class="text-gray-600 text-sm md:text-base">认真回答每一个问题哦～</p>
      </header>

      <!-- 问题区 -->
      <div id="question-container" class="mb-6 md:mb-8">
        <div class="text-[clamp(1.1rem,4.8vw,1.5rem)] font-semibold text-gray-800 text-center mb-4 md:mb-6 min-h-[72px] md:min-h-[84px] flex items-center justify-center leading-snug">
          准备好了吗？
        </div>
      </div>

      <!-- 按钮区：移动端纵向更易点，触控尺寸更大 -->
      <div id="button-container" class="flex flex-col md:flex-row gap-3 md:gap-4 justify-center">
        <button id="start-btn" class="btn-love px-6 md:px-8 min-h-[3.25rem] text-base md:text-lg">
          准备好了 <i class="fa fa-arrow-right ml-2"></i>
        </button>
      </div>

      <!-- 进度条 -->
      <div class="mt-5 md:mt-6">
        <div class="w-full bg-white/60 rounded-full h-2.5 overflow-hidden">
          <div id="progress-bar" class="bg-gradient-to-r from-love-pink to-love-blue h-2.5 rounded-full w-0 transition-all duration-500"></div>
        </div>
        <p id="progress-text" class="text-center text-gray-600 text-xs md:text-sm mt-2">0/4 个问题</p>
      </div>
    </section>
  </main>

  <!-- 成功弹窗 -->
  <div id="success-modal" class="fixed inset-0 z-50 grid place-items-center bg-black/70 opacity-0 pointer-events-none transition-opacity duration-500">
    <div class="glass rounded-3xl p-6 md:p-8 w-[min(92vw,26rem)] md:max-w-md animate-pop">
      <div class="text-center">
        <div class="text-love-pink text-4xl md:text-5xl mb-3 md:mb-4 flex items-center justify-center gap-3">
          <i class="fa fa-heart"></i>
          <i class="fa fa-heart animate-float"></i>
          <i class="fa fa-heart"></i>
        </div>
        <h2 class="text-[clamp(1.3rem,5vw,1.75rem)] font-bold text-love-dark mb-2">我也喜欢你！</h2>
        <p class="text-gray-700 mb-5 md:mb-6 text-base leading-relaxed">
          我就知道你也喜欢我～<br/>以后的每一天，让我们一起走吧！
        </p>
        <button id="close-modal" class="btn-ghost px-6 min-h-[3rem]">
          <i class="fa fa-heart mr-2 text-love-pink"></i> 永远在一起
        </button>
      </div>
    </div>
  </div>

  <!-- 背景音乐：自动播放（无开关）。如果被策略拦截，将静默失败。-->
  <audio id="background-music" autoplay loop preload="auto" playsinline>
    <source src="qwcxx.mp3" type="audio/mpeg" />
    您的浏览器不支持音频播放
  </audio>

  <script>
    // ------------------ 问答数据 ------------------
    const questions = [
      { question: '你觉得我是个有趣的人吗？', options: [ { text: '当然是', type: 'right' }, { text: '一般般', type: 'wrong' } ] },
      { question: '和我聊天会让你觉得开心吗？', options: [ { text: '超开心', type: 'right' }, { text: '还好吧', type: 'wrong' } ] },
      { question: '你喜欢我吗？', options: [ { text: '喜欢呀', type: 'right' }, { text: '不确定', type: 'wrong' } ] },
      { question: '你愿意做我女朋友吗？', options: [ { text: '好的', type: 'right' }, { text: '不要', type: 'wrong' } ] }
    ];

    // ------------------ DOM 元素 ------------------
    const questionContainer = document.getElementById('question-container');
    const buttonContainer = document.getElementById('button-container');
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');
    const startBtn = document.getElementById('start-btn');
    const successModal = document.getElementById('success-modal');
    const closeModal = document.getElementById('close-modal');
    const backgroundMusic = document.getElementById('background-music');

    // ------------------ 状态 ------------------
    let currentQuestionIndex = 0;
    let refuseCount = 0;

    // ------------------ 音乐：页面进入即尽力自动播放（不展示任何开关） ------------------
    function forceAutoplay() {
      try { backgroundMusic.volume = 0.75; } catch(e){}
      const tryPlay = () => backgroundMusic.play().catch(()=>{});
      // 直接尝试 + 轻度重试（兼容部分浏览器加载时机）
      tryPlay();
      setTimeout(tryPlay, 250);
      setTimeout(tryPlay, 1200);
      // 若浏览器需要静音才能自动播，先静音播，缓一缓再尝试取消静音
      backgroundMusic.muted = true;
      tryPlay();
      backgroundMusic.addEventListener('canplay', () => {
        // 尝试去静音（某些浏览器仍可能拦截，这里不做 UI 提示）
        try { backgroundMusic.muted = false; tryPlay(); } catch(e){}
      }, { once: true });
    }
    window.addEventListener('load', forceAutoplay, { once: true });

    // ------------------ 进度条 ------------------
    function updateProgress() {
      const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
      progressBar.style.width = `${progress}%`;
      progressText.textContent = `${currentQuestionIndex + 1}/${questions.length} 个问题`;
    }

    // ------------------ 渲染当前问题 ------------------
    function showCurrentQuestion() {
      const q = questions[currentQuestionIndex];
      questionContainer.innerHTML = `
        <div class="text-[clamp(1.1rem,4.8vw,1.5rem)] font-semibold text-gray-800 text-center mb-4 md:mb-6 min-h-[72px] md:min-h-[84px] flex items-center justify-center leading-snug">
          ${q.question}
        </div>
      `;

      // 清空并添加按钮
      buttonContainer.innerHTML = '';
      q.options.forEach((opt) => {
        const btn = document.createElement('button');
        const isWrong = opt.type === 'wrong';
        btn.className = `${isWrong ? 'btn-ghost' : 'btn-love'} relative px-6 md:px-8 min-h-[3.25rem] text-base md:text-lg`;
        btn.textContent = opt.text;
        btn.dataset.type = opt.type;

        // 最后一题需要特殊 id 以便动画
        if (currentQuestionIndex === questions.length - 1 && isWrong) btn.id = 'refuse-btn';
        if (currentQuestionIndex === questions.length - 1 && !isWrong) btn.id = 'accept-btn';

        btn.addEventListener('click', () => handleOptionClick(opt.type));
        buttonContainer.appendChild(btn);
      });

      updateProgress();
    }

    // ------------------ 成功弹窗 ------------------
    function showSuccessModal() {
      successModal.style.opacity = '1';
      successModal.style.pointerEvents = 'auto';
      spawnConfetti(80);
      const celebration = new Audio('https://cdn.jsdelivr.net/npm/celebration-sound@1.0.0/celebration.mp3');
      celebration.play().catch(()=>{});
    }

    // ------------------ 处理选项点击 ------------------
    function handleOptionClick(type) {
      const isLast = currentQuestionIndex === questions.length - 1;

      if (isLast && type === 'wrong') {
        // 最后一题：点“拒绝”→ 同意变大，拒绝变小
        refuseCount++;
        const acceptBtn = document.getElementById('accept-btn');
        const refuseBtn = document.getElementById('refuse-btn');
        if (!acceptBtn || !refuseBtn) return;

        const grow = 1 + refuseCount * 0.25;          // 同意按钮放大倍数
        const shrink = Math.max(0.15, 1 - refuseCount * 0.2); // 拒绝按钮下限缩放

        acceptBtn.style.transform = `scale(${grow})`;
        acceptBtn.style.zIndex = '2';
        acceptBtn.classList.add('shadow-glow');

        refuseBtn.style.transform = `scale(${shrink})`;
        refuseBtn.style.opacity = `${Math.max(0.2, shrink)}`;

        if (shrink <= 0.16) {
          refuseBtn.remove();
          acceptBtn.classList.add('w-full', 'py-6', 'text-xl', 'md:text-2xl', 'animate-pulse');
          acceptBtn.style.transform = 'scale(1.2)';
          buttonContainer.classList.remove('md:flex-row');
          buttonContainer.classList.add('justify-center');
        }
        return;
      }

      if (type === 'right') {
        currentQuestionIndex++;
        if (currentQuestionIndex < questions.length) {
          showCurrentQuestion();
        } else {
          showSuccessModal();
        }
      } else {
        // 错误（非最后一题）：轻提示
        const wrongBtn = [...buttonContainer.querySelectorAll('button')].find(b => b.dataset.type === 'wrong');
        if (wrongBtn) {
          wrongBtn.textContent = '再想想？';
          wrongBtn.classList.add('animate-pulse');
          setTimeout(() => wrongBtn.classList.remove('animate-pulse'), 800);
        }
      }
    }

    // ------------------ 纸屑生成 ------------------
    function spawnConfetti(n = 60) {
      const colors = ['#ff6b8b', '#8ab4f8', '#ffd166', '#74d3ae', '#b694f6'];
      for (let i = 0; i < n; i++) {
        const el = document.createElement('span');
        el.style.position = 'fixed';
        el.style.top = '-10vh';
        el.style.left = Math.random() * 100 + 'vw';
        el.style.width = '8px';
        el.style.height = '14px';
        el.style.background = colors[Math.floor(Math.random() * colors.length)];
        el.style.opacity = '0.9';
        el.style.transform = `rotate(${Math.random()*360}deg)`;
        el.style.borderRadius = '2px';
        el.style.pointerEvents = 'none';
        el.style.animation = `confetti ${6 + Math.random()*4}s linear forwards`;
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 12000);
      }
    }

    // ------------------ 交互绑定 ------------------
    startBtn.addEventListener('click', () => {
      currentQuestionIndex = 0;
      refuseCount = 0;
      showCurrentQuestion();
    });

    closeModal.addEventListener('click', () => { location.reload(); });
    successModal.addEventListener('click', (e) => { if (e.target === successModal) location.reload(); });
  </script>
</body>
</html>

